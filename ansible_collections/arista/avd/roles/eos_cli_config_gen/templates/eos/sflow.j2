{# eos - SFlow #}
{% if sflow is arista.avd.defined %}
!
{%     if sflow.sample is arista.avd.defined %}
sflow sample{% if sflow.dangerous is arista.avd.defined(true) %} dangerous{% endif %} {{ sflow.sample }}
{%     endif %}
{%   if sflow.vrfs is arista.avd.defined %}
{%     for vrf in sflow.vrfs | arista.avd.natural_sort %}
{%       if sflow.vrfs[vrf].destinations is arista.avd.defined %}
{%          for destination in sflow.vrfs[vrf].destinations | arista.avd.natural_sort %}
sflow vrf {{ vrf }} destination {{ destination }}{% if sflow.vrfs[vrf].destinations[destination].port is arista.avd.defined %} {{ sflow.vrfs[vrf].destinations[destination].port }}{% endif %}

{%          endfor %}
{%       endif %}
{%       if sflow.vrfs[vrf].source_interface is arista.avd.defined %}
sflow vrf {{ vrf }} source-interface {{ sflow.vrfs[vrf].source_interface }}
{%       endif %}
{%     endfor %}
{%   endif %}
{%     if sflow.destinations is arista.avd.defined %}
{%      for destination in sflow.destinations | arista.avd.natural_sort %}
sflow destination {{ destination }}{% if sflow.destinations[destination].port is arista.avd.defined %} {{ sflow.destinations[destination].port }}{% endif %}

{%      endfor %}
{%     endif %}
{%     if sflow.source_interface is arista.avd.defined %}
sflow source-interface {{ sflow.source_interface }}
{%     endif %}
{%     if sflow.run is defined and sflow.run == true %}
sflow run
{%     endif %}
{% endif %}
