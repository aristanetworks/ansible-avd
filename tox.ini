
[tox]
minversion = 1.4.2
envlist = linters
skipsdist = True

[testenv]
; basepython = python3
basepython = python3.6
deps = -r{toxinidir}/development/requirements.txt
       -r{toxinidir}/development/requirements-tox.txt

[testenv:reformat]
install_command = pip install {opts} {packages}
commands =
  black -v -l79 {toxinidir}/ansible_collections/arista/avd/plugins

[testenv:black]
install_command = pip install {opts} {packages}
commands =
  black -v -l79 --diff --check {toxinidir}/ansible_collections/arista/avd/plugins

[testenv:linters]
install_command = pip install {opts} {packages}
commands =
  black -v -l79 --diff --check {toxinidir}
  flake8 {posargs}
  yamllint -c {toxinidir}/.yamllint ansible_collections/arista/avd/roles

[testenv:venv]
commands = {posargs}

# Linters
[testenv:pep8]
basepython = python3
skip_install = true
deps =
    flake8
    flake8-bugbear
    flake8-docstrings>=1.3.1
    flake8-import-order>=0.9
    flake8-typing-imports>=1.1
    pep8-naming
commands =
    flake8 {toxinidir}/ansible_collections/arista/avd/plugins

[flake8]
# E123, E125 skipped as they are invalid PEP-8.
show-source = True
ignore = E123,E125,E402,W503
max-line-length = 160
builtins = _
exclude = .git,.tox,ansible_collections/arista/avd/tests/unit/compat/, ansible_collections/arista/avd/docs/_build
